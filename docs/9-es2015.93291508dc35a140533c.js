(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{CIHk:function(e){e.exports=JSON.parse('{"name":"@aws-sdk/client-lex-runtime-service","description":"AWS SDK for JavaScript Lex Runtime Service Client for Node.js, Browser and React Native","version":"3.6.1","scripts":{"clean":"yarn remove-definitions && yarn remove-dist && yarn remove-documentation","build-documentation":"yarn remove-documentation && typedoc ./","prepublishOnly":"yarn build","pretest":"yarn build:cjs","remove-definitions":"rimraf ./types","remove-dist":"rimraf ./dist","remove-documentation":"rimraf ./docs","test:unit":"mocha **/cjs/**/*.spec.js","test":"yarn test:unit","build:cjs":"tsc -p tsconfig.json","build:es":"tsc -p tsconfig.es.json","build":"yarn build:cjs && yarn build:es","postbuild":"downlevel-dts types types/ts3.4"},"main":"./dist/cjs/index.js","types":"./types/index.d.ts","module":"./dist/es/index.js","browser":{"./runtimeConfig":"./runtimeConfig.browser"},"react-native":{"./runtimeConfig":"./runtimeConfig.native"},"sideEffects":false,"dependencies":{"@aws-crypto/sha256-browser":"^1.0.0","@aws-crypto/sha256-js":"^1.0.0","@aws-sdk/config-resolver":"3.6.1","@aws-sdk/credential-provider-node":"3.6.1","@aws-sdk/fetch-http-handler":"3.6.1","@aws-sdk/hash-node":"3.6.1","@aws-sdk/invalid-dependency":"3.6.1","@aws-sdk/middleware-content-length":"3.6.1","@aws-sdk/middleware-host-header":"3.6.1","@aws-sdk/middleware-logger":"3.6.1","@aws-sdk/middleware-retry":"3.6.1","@aws-sdk/middleware-serde":"3.6.1","@aws-sdk/middleware-signing":"3.6.1","@aws-sdk/middleware-stack":"3.6.1","@aws-sdk/middleware-user-agent":"3.6.1","@aws-sdk/node-config-provider":"3.6.1","@aws-sdk/node-http-handler":"3.6.1","@aws-sdk/protocol-http":"3.6.1","@aws-sdk/smithy-client":"3.6.1","@aws-sdk/types":"3.6.1","@aws-sdk/url-parser":"3.6.1","@aws-sdk/url-parser-native":"3.6.1","@aws-sdk/util-base64-browser":"3.6.1","@aws-sdk/util-base64-node":"3.6.1","@aws-sdk/util-body-length-browser":"3.6.1","@aws-sdk/util-body-length-node":"3.6.1","@aws-sdk/util-user-agent-browser":"3.6.1","@aws-sdk/util-user-agent-node":"3.6.1","@aws-sdk/util-utf8-browser":"3.6.1","@aws-sdk/util-utf8-node":"3.6.1","tslib":"^2.0.0"},"devDependencies":{"@aws-sdk/client-documentation-generator":"3.6.1","@types/chai":"^4.2.11","@types/mocha":"^8.0.4","@types/node":"^12.7.5","downlevel-dts":"0.7.0","jest":"^26.1.0","rimraf":"^3.0.0","typedoc":"^0.19.2","typescript":"~4.1.2"},"engines":{"node":">=10.0.0"},"typesVersions":{"<4.0":{"types/*":["types/ts3.4/*"]}},"author":{"name":"AWS SDK for JavaScript Team","url":"https://aws.amazon.com/javascript/"},"license":"Apache-2.0","homepage":"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-lex-runtime-service","repository":{"type":"git","url":"https://github.com/aws/aws-sdk-js-v3.git","directory":"clients/client-lex-runtime-service"}}')},OkRK:function(e,t,n){"use strict";n.r(t),n.d(t,"amplify_chatbot",function(){return b});var i=n("hKmi"),o=n("Nt7R"),a=n("HzrR"),r=n("JIIv"),s=n("sPRy"),c=n("/vcS"),l=n("tZc9");const u=(e,t,n)=>{for(let i=0;i<n.length;i++)e.setUint8(t+i,n.charCodeAt(i))},d=new o.a("AudioRecorder");class m{constructor(e){this.streamBuffer=[],this.streamBufferLength=0,this.recording=!1,this.options=e}async init(){if(!Object(a.b)().isBrowser)return this.audioSupported=!1,Promise.reject("Audio is not supported");window.AudioContext=window.AudioContext||window.webkitAudioContext,this.audioContext=new AudioContext,await navigator.mediaDevices.getUserMedia({audio:!0}).then(e=>{this.audioSupported=!0,this.setupAudioNodes(e)}).catch(()=>(this.audioSupported=!1,Promise.reject("Audio is not supported")))}async setupAudioNodes(e){try{await this.audioContext.resume()}catch(o){d.error(o)}const t=this.audioContext.createMediaStreamSource(e),n=this.audioContext.createScriptProcessor(4096,1,1);n.onaudioprocess=e=>{if(!this.recording)return;const t=e.inputBuffer.getChannelData(0);this.streamBuffer.push(new Float32Array(t)),this.streamBufferLength+=t.length,this.analyse()};const i=this.audioContext.createAnalyser();i.minDecibels=-90,i.maxDecibels=-10,i.smoothingTimeConstant=.85,t.connect(i),i.connect(n),n.connect(t.context.destination),this.analyserNode=i}async startRecording(e,t){if(this.recording||!this.audioSupported)return;this.onSilence=e||function(){},this.visualizer=t||function(){};const n=this.audioContext;try{await n.resume()}catch(i){d.error(i)}this.start=Date.now(),this.recording=!0}stopRecording(){this.audioSupported&&(this.recording=!1)}clear(){this.stopRecording(),this.streamBufferLength=0,this.streamBuffer=[]}play(e){if(!e||!this.audioSupported)return;const t=new Blob([e]);return new Promise((e,n)=>{const i=new FileReader;i.onload=()=>{this.playbackSource&&this.playbackSource.disconnect(),this.playbackSource=this.audioContext.createBufferSource(),this.audioContext.decodeAudioData(i.result,t=>{this.playbackSource.buffer=t,this.playbackSource.connect(this.audioContext.destination),this.playbackSource.onended=()=>e(),this.playbackSource.start(0)},e=>n(e))},i.onerror=()=>n(),i.readAsArrayBuffer(t)})}stop(){this.playbackSource&&this.playbackSource.stop()}analyse(){if(!this.audioSupported)return;const e=this.analyserNode;e.fftSize=2048;const t=e.fftSize,n=new Uint8Array(t),i=this.options.amplitude,o=this.options.time;e.getByteTimeDomainData(n),this.visualizer(n,t);for(let a=0;a<t;a++){const e=n[a]/128-1;(e>i||e<-1*i)&&(this.start=Date.now())}Date.now()-this.start>o&&this.onSilence()}async exportWAV(e=16e3){if(!this.audioSupported)return;const t=((e,t,n,i)=>{const o=((e,t)=>{const n=2*e.length,i=8+n,o=new ArrayBuffer(36+i),a=new DataView(o);return u(a,0,"RIFF"),a.setUint32(4,24+i,!0),u(a,8,"WAVE"),u(a,12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,1,!0),a.setUint32(24,t,!0),a.setUint32(28,2*t,!0),a.setUint16(32,2,!0),a.setUint16(34,16,!0),u(a,36,"data"),a.setUint32(40,n,!0),((e,t,n)=>{let i=44;for(let o=0;o<n.length;o++,i+=2){const t=Math.max(-1,Math.min(1,n[o]));e.setInt16(i,t<0?32768*t:32767*t,!0)}})(a,0,e),a})(((e,t,n)=>{if(n===t)return e;const i=t/n,o=Math.round(e.length/i),a=new Float32Array(o);let r=0,s=0;for(;r<a.length;){const t=Math.round((r+1)*i);let n=0,o=0;for(let i=s;i<t&&i<e.length;i++)n+=e[i],o++;a[r]=n/o,r++,s=t}return a})(((e,t)=>{const n=new Float32Array(t);let i=0;for(let o=0;o<e.length;o++)n.set(e[o],i),i+=e[o].length;return n})(e,t),n,i),i);return new Blob([o],{type:"application/octet-stream"})})(this.streamBuffer,this.streamBufferLength,this.audioContext.sampleRate,e);return this.clear(),t}}var p,f,h;!function(e){e[e.Initial=0]="Initial",e[e.Listening=1]="Listening",e[e.SendingText=2]="SendingText",e[e.SendingVoice=3]="SendingVoice",e[e.Error=4]="Error"}(p||(p={})),function(e){e.Bot="bot",e.User="user"}(f||(f={})),function(e){e[e.Recoverable=0]="Recoverable",e[e.Unrecoverable=1]="Unrecoverable"}(h||(h={}));const b=class{constructor(e){Object(i.k)(this,e),this.clearOnComplete=!1,this.conversationModeOn=!1,this.botTitle=s.a.CHATBOT_TITLE,this.voiceEnabled=!1,this.textEnabled=!0,this.silenceTime=1500,this.silenceThreshold=.2,this.messages=[],this.text="",this.chatState=p.Initial,this.messageJSX=e=>{const t=e.map(e=>Object(i.i)("div",{class:"bubble "+e.from},e.content));if(this.chatState===p.SendingText||this.chatState===p.SendingVoice){const e=this.chatState===p.SendingText?f.Bot:f.User;t.push(Object(i.i)("div",{class:"bubble "+e},Object(i.i)("div",{class:"dot-flashing "+e},Object(i.i)("span",{class:"dot left"}),Object(i.i)("span",{class:"dot middle"}),Object(i.i)("span",{class:"dot right"}))))}return t},this.chatCompleted=Object(i.f)(this,"chatCompleted",7)}submitHandler(e){this.sendTextMessage()}componentWillLoad(){if(!l.a||"function"!=typeof l.a.onComplete)throw new Error(c.m);this.validateProps()}componentDidRender(){const e=this.element.shadowRoot.querySelector(".body");e.scrollTop=e.scrollHeight}validateProps(){if(!this.voiceEnabled&&!this.textEnabled)return void this.setError(s.a.CHAT_DISABLED_ERROR,h.Unrecoverable);if(!this.botName)return void this.setError(s.a.NO_BOT_NAME_ERROR,h.Unrecoverable);this.welcomeMessage&&this.appendToChat(this.welcomeMessage,f.Bot),this.voiceEnabled&&(this.audioRecorder=new m({time:this.silenceTime,amplitude:this.silenceThreshold}),this.audioRecorder.init().catch(e=>{this.setError(e,h.Recoverable)}));const e=(e,t)=>{this.chatCompleted.emit({data:t,err:e}),this.clearOnComplete?this.reset():this.chatState=p.Initial};try{l.a.onComplete(this.botName,e)}catch(t){this.setError(t,h.Unrecoverable)}}handleMicButton(){this.chatState===p.Initial&&(this.audioRecorder.stop(),this.chatState=p.Listening,this.audioRecorder.startRecording(()=>this.handleSilence(),(e,t)=>this.visualizer(e,t)))}handleSilence(){this.chatState=p.SendingVoice,this.audioRecorder.stopRecording(),this.audioRecorder.exportWAV().then(e=>{this.sendVoiceMessage(e)})}handleTextChange(e){this.text=e.target.value}handleCancelButton(){this.audioRecorder.clear(),this.chatState=p.Initial}handleToastClose(e){this.error=void 0,e===h.Recoverable&&(this.chatState=p.Initial)}visualizer(e,t){((e,t,n)=>{if(!n)return;if(!Object(a.b)().isBrowser)throw new Error("Visualization is not supported on non-browsers.");const{width:i,height:o}=n.getBoundingClientRect();n.width=i,n.height=o;const r=n.getContext("2d");r.fillStyle="white",r.clearRect(0,0,i,o),requestAnimationFrame(()=>{r.fillRect(0,0,i,o),r.lineWidth=1;const a=getComputedStyle(document.documentElement).getPropertyValue("--amplify-primary-color");r.strokeStyle=a&&""!==a?a:"#ff9900",r.beginPath();const s=1*i/t;let c=0;for(let n=0;n<t||n%3==0;n++){const t=e[n]/128*o/2;0===n?r.moveTo(c,t):r.lineTo(c,t),c+=s}r.lineTo(n.width,n.height/2),r.stroke()})})(e,t,this.element.shadowRoot.querySelector("canvas"))}async sendTextMessage(){if(0===this.text.length||this.chatState!==p.Initial)return;const e=this.text;let t;this.text="",this.appendToChat(e,f.User),this.chatState=p.SendingText;try{t=await l.a.send(this.botName,e)}catch(n){return void this.setError(n,h.Recoverable)}t.message&&this.appendToChat(t.message,f.Bot),this.chatState=p.Initial}async sendVoiceMessage(e){const t={content:e,options:{messageType:"voice"}};let n;try{n=await l.a.send(this.botName,t)}catch(o){return void this.setError(o,h.Recoverable)}this.chatState=p.Initial;const i=n.dialogState;n.inputTranscript&&this.appendToChat(n.inputTranscript,f.User),this.appendToChat(n.message,f.Bot),await this.audioRecorder.play(n.audioStream).then(()=>{this.conversationModeOn&&"Fulfilled"!==i&&"Failed"!==i&&this.chatState===p.Initial&&this.handleMicButton()}).catch(e=>this.setError(e,h.Recoverable))}appendToChat(e,t){this.messages=[...this.messages,{content:e,from:t}]}setError(e,t){const n="string"==typeof e?e:e.message;this.chatState=p.Error,this.error={message:n,errorType:t}}reset(){this.chatState=p.Initial,this.text="",this.error=void 0,this.messages=[],this.welcomeMessage&&this.appendToChat(this.welcomeMessage,f.Bot),this.audioRecorder&&this.audioRecorder.clear()}listeningFooterJSX(){return[Object(i.i)("canvas",{height:"50"}),Object(i.i)("amplify-button",{"data-test":"chatbot-cancel-button",handleButtonClick:()=>this.handleCancelButton(),class:"icon-button",variant:"icon",icon:"ban"})]}footerJSX(){if(this.chatState===p.Listening)return this.listeningFooterJSX();const e=this.textEnabled?s.a.TEXT_INPUT_PLACEHOLDER:s.a.VOICE_INPUT_PLACEHOLDER;return[Object(i.i)("amplify-input",{placeholder:r.a.get(e),description:"text",handleInputChange:e=>this.handleTextChange(e),value:this.text,disabled:this.chatState===p.Error||!this.textEnabled}),this.voiceEnabled&&Object(i.i)("amplify-button",{"data-test":"chatbot-mic-button",handleButtonClick:()=>this.handleMicButton(),class:"icon-button",variant:"icon",icon:"microphone",disabled:this.chatState===p.Error||this.chatState!==p.Initial}),this.textEnabled&&Object(i.i)("amplify-button",{"data-test":"chatbot-send-button",class:"icon-button",variant:"icon",icon:"send",handleButtonClick:()=>this.sendTextMessage(),disabled:this.chatState===p.Error||this.chatState!==p.Initial})]}errorToast(){if(!this.error)return;const{message:e,errorType:t}=this.error;return Object(i.i)("amplify-toast",{message:r.a.get(e),handleClose:()=>this.handleToastClose(t)})}render(){return Object(i.i)(i.b,null,Object(i.i)("div",{class:"amplify-chatbot"},Object(i.i)("slot",{name:"header"},Object(i.i)("div",{class:"header","data-test":"chatbot-header"},r.a.get(this.botTitle))),Object(i.i)("div",{class:"body","data-test":"chatbot-body"},this.messageJSX(this.messages)),Object(i.i)("div",{class:"footer","data-test":"chatbot-footer"},this.footerJSX()),this.errorToast()))}get element(){return Object(i.h)(this)}};b.style=".bot .dot{background-color:var(--bot-dot-color)}.user .dot{background-color:var(--user-dot-color)}.dot-flashing{width:2.625rem}.dot-flashing .dot{display:inline-block;width:0.625rem;height:0.625rem;border-radius:10rem;opacity:0.65}.dot-flashing .left{-webkit-animation:dot-flashing 1s infinite alternate;animation:dot-flashing 1s infinite alternate;-webkit-animation-delay:0s;animation-delay:0s}.dot-flashing .middle{margin-left:0.375rem;margin-right:0.375rem;-webkit-animation:dot-flashing 1s infinite linear alternate;animation:dot-flashing 1s infinite linear alternate;-webkit-animation-delay:0.5s;animation-delay:0.5s}.dot-flashing .right{-webkit-animation:dot-flashing 1s infinite alternate;animation:dot-flashing 1s infinite alternate;-webkit-animation-delay:1s;animation-delay:1s}@-webkit-keyframes dot-flashing{0%{opacity:0.65}50%,100%{opacity:0.1}}@keyframes dot-flashing{0%{opacity:0.65}50%,100%{opacity:0.1}}:host{--width:28.75rem;--height:37.5rem;--header-color:var(--amplify-secondary-color);--header-size:var(--amplify-text-lg);--bot-background-color:rgb(230, 230, 230);--bot-text-color:black;--bot-dot-color:var(--bot-text-color);--user-background-color:var(--amplify-blue);--user-text-color:var(--amplify-white);--user-dot-color:var(--user-text-color)}.amplify-chatbot{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-direction:column;flex-direction:column;background-color:var(--background-color);border-radius:0.375rem;-webkit-box-shadow:0.0625rem 0rem 0.25rem 0 rgba(0, 0, 0, 0.15);box-shadow:0.0625rem 0rem 0.25rem 0 rgba(0, 0, 0, 0.15);-webkit-box-sizing:border-box;box-sizing:border-box;font-family:var(--amplify-font-family);margin-bottom:1rem;width:100%;height:var(--height);max-width:var(--width)}@media (min-width: 672px){.amplify-chatbot{width:var(--width)}}.header{padding:1.25rem 0.375rem 1.25rem 0.375rem;color:var(--header-color);font-size:var(--header-size);font-weight:bold;text-align:center;word-wrap:break-word}.body{border-top:0.0625rem solid rgba(0, 0, 0, 0.05);padding:1.5rem 1rem 0 1rem;display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1;-ms-flex-direction:column;flex-direction:column;overflow:auto}.bubble{max-width:100%;padding:0.8em 1.4em;text-align:left;word-wrap:break-word;margin-bottom:0.625rem}.bot{margin-right:auto;background-color:var(--bot-background-color);color:var(--bot-text-color);border-radius:1.5rem 1.5rem 1.5rem 0}.user{margin-left:auto;background-color:var(--user-background-color);color:var(--user-text-color);border-radius:1.5rem 1.5rem 0 1.5rem}.footer{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;border-top:0.062rem solid rgba(0, 0, 0, 0.05);padding-right:0.625rem;min-height:3.125rem}.footer amplify-input{--border:none;--margin:0;-ms-flex-positive:1;flex-grow:1}canvas{margin-left:0.625rem;margin-right:0.625rem;-ms-flex-positive:1;flex-grow:1;height:3.125rem}.icon-button{--icon-height:1.25rem;--icon-fill:var(--amplify-primary-color);--padding:0.625rem;--width:auto}"},tZc9:function(e,t,n){"use strict";n.d(t,"a",function(){return it});var i,o,a,r,s,c,l,u,d,m,p,f,h,b,v,g,y,w,x,O,S,j,E,C,T,L,I,k,A,N,z,R,_,P,B,F,M,U=n("Nt7R"),D=n("fQM2"),$=function(){return($=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},q=new U.a("AbstractInteractionsProvider"),V=function(){function e(e){void 0===e&&(e={}),this._config=e}return e.prototype.configure=function(e){return void 0===e&&(e={}),this._config=$($({},this._config),e),q.debug("configure "+this.getProviderName(),this._config),this.options},e.prototype.getCategory=function(){return"Interactions"},Object.defineProperty(e.prototype,"options",{get:function(){return $({},this._config)},enumerable:!0,configurable:!0}),e}(),H=n("mrSG"),W=n("CIHk"),J=n("viNG"),G=n("LUnR"),X=n("J2eM"),Y=n("UMev"),K=n("S3Uu"),Z=n("N9sX"),Q=n("wU8f"),ee=n("XWO8"),te=new Set(["af-south-1","ap-east-1","ap-northeast-1","ap-northeast-2","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","eu-central-1","eu-north-1","eu-south-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-west-1","us-west-2"]),ne=new Set(["cn-north-1","cn-northwest-1"]),ie=new Set(["us-iso-east-1"]),oe=new Set(["us-isob-east-1"]),ae=new Set(["us-gov-east-1","us-gov-west-1"]),re={apiVersion:"2016-11-28",disableHostPrefix:!1,logger:{},regionInfoProvider:function(e,t){var n=void 0;switch(e){case"ap-northeast-1":n={hostname:"runtime.lex.ap-northeast-1.amazonaws.com",partition:"aws",signingService:"lex"};break;case"ap-southeast-1":n={hostname:"runtime.lex.ap-southeast-1.amazonaws.com",partition:"aws",signingService:"lex"};break;case"ap-southeast-2":n={hostname:"runtime.lex.ap-southeast-2.amazonaws.com",partition:"aws",signingService:"lex"};break;case"eu-central-1":n={hostname:"runtime.lex.eu-central-1.amazonaws.com",partition:"aws",signingService:"lex"};break;case"eu-west-1":n={hostname:"runtime.lex.eu-west-1.amazonaws.com",partition:"aws",signingService:"lex"};break;case"eu-west-2":n={hostname:"runtime.lex.eu-west-2.amazonaws.com",partition:"aws",signingService:"lex"};break;case"us-east-1":n={hostname:"runtime.lex.us-east-1.amazonaws.com",partition:"aws",signingService:"lex"};break;case"us-west-2":n={hostname:"runtime.lex.us-west-2.amazonaws.com",partition:"aws",signingService:"lex"};break;default:te.has(e)&&(n={hostname:"runtime.lex.{region}.amazonaws.com".replace("{region}",e),partition:"aws",signingService:"lex"}),ne.has(e)&&(n={hostname:"runtime.lex.{region}.amazonaws.com.cn".replace("{region}",e),partition:"aws-cn"}),ie.has(e)&&(n={hostname:"runtime.lex.{region}.c2s.ic.gov".replace("{region}",e),partition:"aws-iso"}),oe.has(e)&&(n={hostname:"runtime.lex.{region}.sc2s.sgov.gov".replace("{region}",e),partition:"aws-iso-b"}),ae.has(e)&&(n={hostname:"runtime.lex.{region}.amazonaws.com".replace("{region}",e),partition:"aws-us-gov"}),void 0===n&&(n={hostname:"runtime.lex.{region}.amazonaws.com".replace("{region}",e),partition:"aws",signingService:"lex"})}return Promise.resolve(Object(H.a)({signingService:"lex"},n))},serviceId:"Lex Runtime Service",urlParser:n("2j7m").a},se=Object(H.a)(Object(H.a)({},re),{runtime:"browser",base64Decoder:K.a,base64Encoder:K.b,bodyLengthChecker:Z.a,credentialDefaultProvider:function(e){return function(){return Promise.reject(new Error("Credential is missing"))}},defaultUserAgentProvider:Object(Q.a)({serviceId:re.serviceId,clientVersion:W.version}),maxAttempts:Y.a,region:Object(X.a)("Region is missing"),requestHandler:new G.a,sha256:J.Sha256,streamCollector:G.b,utf8Decoder:ee.fromUtf8,utf8Encoder:ee.toUtf8}),ce=n("NtRE"),le=n("naxo"),ue=n("Nl9j"),de=n("+tRG"),me=n("qcsT"),pe=n("87YT"),fe=n("EI00"),he=function(e){function t(t){var n=this,i=Object(H.a)(Object(H.a)({},se),t),o=Object(ce.b)(i),a=Object(ce.a)(o),r=Object(me.b)(a),s=Object(Y.c)(r),c=Object(ue.b)(s),l=Object(pe.b)(c);return(n=e.call(this,l)||this).config=l,n.middlewareStack.use(Object(me.a)(n.config)),n.middlewareStack.use(Object(Y.b)(n.config)),n.middlewareStack.use(Object(le.a)(n.config)),n.middlewareStack.use(Object(ue.a)(n.config)),n.middlewareStack.use(Object(de.a)(n.config)),n.middlewareStack.use(Object(pe.a)(n.config)),n}return Object(H.d)(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(fe.a);(i||(i={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(o||(o={})).filterSensitiveLog=function(e){return Object(H.a)(Object(H.a)({},e),e.parameters&&{parameters:fe.d})},(a||(a={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(r||(r={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(s||(s={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(c||(c={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(l||(l={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(u||(u={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(d||(d={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(m||(m={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},function(e){e.FAILED="Failed",e.FULFILLED="Fulfilled",e.READY_FOR_FULFILLMENT="ReadyForFulfillment"}(p||(p={})),function(e){e.COMPOSITE="Composite",e.CUSTOM_PAYLOAD="CustomPayload",e.PLAIN_TEXT="PlainText",e.SSML="SSML"}(f||(f={})),function(e){e.CLOSE="Close",e.CONFIRM_INTENT="ConfirmIntent",e.DELEGATE="Delegate",e.ELICIT_INTENT="ElicitIntent",e.ELICIT_SLOT="ElicitSlot"}(h||(h={})),(b||(b={})).filterSensitiveLog=function(e){return Object(H.a)(Object(H.a)(Object(H.a)({},e),e.slots&&{slots:fe.d}),e.message&&{message:fe.d})},function(e){e.CONFIRMED="Confirmed",e.DENIED="Denied",e.NONE="None"}(v||(v={})),(g||(g={})).filterSensitiveLog=function(e){return Object(H.a)(Object(H.a)({},e),e.slots&&{slots:fe.d})},(y||(y={})).filterSensitiveLog=function(e){return Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)({},e),e.recentIntentSummaryView&&{recentIntentSummaryView:e.recentIntentSummaryView.map(function(e){return g.filterSensitiveLog(e)})}),e.sessionAttributes&&{sessionAttributes:fe.d}),e.dialogAction&&{dialogAction:b.filterSensitiveLog(e.dialogAction)}),e.activeContexts&&{activeContexts:fe.d})},(w||(w={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(x||(x={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(O||(O={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(S||(S={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(j||(j={})).filterSensitiveLog=function(e){return Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)({},e),e.sessionAttributes&&{sessionAttributes:fe.d}),e.requestAttributes&&{requestAttributes:fe.d}),e.activeContexts&&{activeContexts:fe.d})},function(e){e.CONFIRM_INTENT="ConfirmIntent",e.ELICIT_INTENT="ElicitIntent",e.ELICIT_SLOT="ElicitSlot",e.FAILED="Failed",e.FULFILLED="Fulfilled",e.READY_FOR_FULFILLMENT="ReadyForFulfillment"}(E||(E={})),(C||(C={})).filterSensitiveLog=function(e){return Object(H.a)(Object(H.a)(Object(H.a)({},e),e.message&&{message:fe.d}),e.activeContexts&&{activeContexts:fe.d})},(T||(T={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(L||(L={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(I||(I={})).filterSensitiveLog=function(e){return Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)({},e),e.sessionAttributes&&{sessionAttributes:fe.d}),e.requestAttributes&&{requestAttributes:fe.d}),e.inputText&&{inputText:fe.d}),e.activeContexts&&{activeContexts:fe.d})},(k||(k={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(A||(A={})).filterSensitiveLog=function(e){return Object(H.a)(Object(H.a)({},e),e.slots&&{slots:fe.d})},function(e){e.GENERIC="application/vnd.amazonaws.card.generic"}(N||(N={})),(z||(z={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(R||(R={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(_||(_={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(P||(P={})).filterSensitiveLog=function(e){return Object(H.a)({},e)},(B||(B={})).filterSensitiveLog=function(e){return Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)({},e),e.alternativeIntents&&{alternativeIntents:e.alternativeIntents.map(function(e){return A.filterSensitiveLog(e)})}),e.slots&&{slots:fe.d}),e.sessionAttributes&&{sessionAttributes:fe.d}),e.message&&{message:fe.d}),e.activeContexts&&{activeContexts:fe.d})},(F||(F={})).filterSensitiveLog=function(e){return Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)({},e),e.sessionAttributes&&{sessionAttributes:fe.d}),e.dialogAction&&{dialogAction:b.filterSensitiveLog(e.dialogAction)}),e.recentIntentSummaryView&&{recentIntentSummaryView:e.recentIntentSummaryView.map(function(e){return g.filterSensitiveLog(e)})}),e.activeContexts&&{activeContexts:fe.d})},(M||(M={})).filterSensitiveLog=function(e){return Object(H.a)(Object(H.a)(Object(H.a)({},e),e.message&&{message:fe.d}),e.activeContexts&&{activeContexts:fe.d})};var be,ve=n("Enk7"),ge=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var n,i,o,a,r,s,c,l,u,d,m,p,f,h,b,v,g,y;return Object(H.e)(this,function(w){switch(w.label){case 0:return i=[Object(H.a)({},e)],y={},[4,qe(e.body,t)];case 1:switch(n=H.a.apply(void 0,i.concat([(y.body=w.sent(),y)])),a="UnknownError",a=Ve(e,n.body)){case"BadGatewayException":case"com.amazonaws.lexruntimeservice#BadGatewayException":return[3,2];case"BadRequestException":case"com.amazonaws.lexruntimeservice#BadRequestException":return[3,4];case"ConflictException":case"com.amazonaws.lexruntimeservice#ConflictException":return[3,6];case"DependencyFailedException":case"com.amazonaws.lexruntimeservice#DependencyFailedException":return[3,8];case"InternalFailureException":case"com.amazonaws.lexruntimeservice#InternalFailureException":return[3,10];case"LimitExceededException":case"com.amazonaws.lexruntimeservice#LimitExceededException":return[3,12];case"LoopDetectedException":case"com.amazonaws.lexruntimeservice#LoopDetectedException":return[3,14];case"NotAcceptableException":case"com.amazonaws.lexruntimeservice#NotAcceptableException":return[3,16];case"NotFoundException":case"com.amazonaws.lexruntimeservice#NotFoundException":return[3,18];case"RequestTimeoutException":case"com.amazonaws.lexruntimeservice#RequestTimeoutException":return[3,20];case"UnsupportedMediaTypeException":case"com.amazonaws.lexruntimeservice#UnsupportedMediaTypeException":return[3,22]}return[3,24];case 2:return r=[{}],[4,we(n,t)];case 3:return o=H.a.apply(void 0,[H.a.apply(void 0,r.concat([w.sent()])),{name:a,$metadata:De(e)}]),[3,25];case 4:return s=[{}],[4,xe(n,t)];case 5:return o=H.a.apply(void 0,[H.a.apply(void 0,s.concat([w.sent()])),{name:a,$metadata:De(e)}]),[3,25];case 6:return c=[{}],[4,Oe(n,t)];case 7:return o=H.a.apply(void 0,[H.a.apply(void 0,c.concat([w.sent()])),{name:a,$metadata:De(e)}]),[3,25];case 8:return l=[{}],[4,Se(n,t)];case 9:return o=H.a.apply(void 0,[H.a.apply(void 0,l.concat([w.sent()])),{name:a,$metadata:De(e)}]),[3,25];case 10:return u=[{}],[4,je(n,t)];case 11:return o=H.a.apply(void 0,[H.a.apply(void 0,u.concat([w.sent()])),{name:a,$metadata:De(e)}]),[3,25];case 12:return d=[{}],[4,Ee(n,t)];case 13:return o=H.a.apply(void 0,[H.a.apply(void 0,d.concat([w.sent()])),{name:a,$metadata:De(e)}]),[3,25];case 14:return m=[{}],[4,Ce(n,t)];case 15:return o=H.a.apply(void 0,[H.a.apply(void 0,m.concat([w.sent()])),{name:a,$metadata:De(e)}]),[3,25];case 16:return p=[{}],[4,Te(n,t)];case 17:return o=H.a.apply(void 0,[H.a.apply(void 0,p.concat([w.sent()])),{name:a,$metadata:De(e)}]),[3,25];case 18:return f=[{}],[4,Le(n,t)];case 19:return o=H.a.apply(void 0,[H.a.apply(void 0,f.concat([w.sent()])),{name:a,$metadata:De(e)}]),[3,25];case 20:return h=[{}],[4,Ie(n,t)];case 21:return o=H.a.apply(void 0,[H.a.apply(void 0,h.concat([w.sent()])),{name:a,$metadata:De(e)}]),[3,25];case 22:return b=[{}],[4,ke(n,t)];case 23:return o=H.a.apply(void 0,[H.a.apply(void 0,b.concat([w.sent()])),{name:a,$metadata:De(e)}]),[3,25];case 24:a=(v=n.body).code||v.Code||a,o=Object(H.a)(Object(H.a)({},v),{name:""+a,message:v.message||v.Message||a,$fault:"client",$metadata:De(e)}),w.label=25;case 25:return o.message=g=o.message||o.Message||a,delete o.Message,[2,Promise.reject(Object.assign(new Error(g),o))]}})})},ye=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var n,i,o,a,r,s,c,l,u,d,m,p,f,h,b;return Object(H.e)(this,function(v){switch(v.label){case 0:return i=[Object(H.a)({},e)],b={},[4,qe(e.body,t)];case 1:switch(n=H.a.apply(void 0,i.concat([(b.body=v.sent(),b)])),a="UnknownError",a=Ve(e,n.body)){case"BadGatewayException":case"com.amazonaws.lexruntimeservice#BadGatewayException":return[3,2];case"BadRequestException":case"com.amazonaws.lexruntimeservice#BadRequestException":return[3,4];case"ConflictException":case"com.amazonaws.lexruntimeservice#ConflictException":return[3,6];case"DependencyFailedException":case"com.amazonaws.lexruntimeservice#DependencyFailedException":return[3,8];case"InternalFailureException":case"com.amazonaws.lexruntimeservice#InternalFailureException":return[3,10];case"LimitExceededException":case"com.amazonaws.lexruntimeservice#LimitExceededException":return[3,12];case"LoopDetectedException":case"com.amazonaws.lexruntimeservice#LoopDetectedException":return[3,14];case"NotFoundException":case"com.amazonaws.lexruntimeservice#NotFoundException":return[3,16]}return[3,18];case 2:return r=[{}],[4,we(n,t)];case 3:return o=H.a.apply(void 0,[H.a.apply(void 0,r.concat([v.sent()])),{name:a,$metadata:De(e)}]),[3,19];case 4:return s=[{}],[4,xe(n,t)];case 5:return o=H.a.apply(void 0,[H.a.apply(void 0,s.concat([v.sent()])),{name:a,$metadata:De(e)}]),[3,19];case 6:return c=[{}],[4,Oe(n,t)];case 7:return o=H.a.apply(void 0,[H.a.apply(void 0,c.concat([v.sent()])),{name:a,$metadata:De(e)}]),[3,19];case 8:return l=[{}],[4,Se(n,t)];case 9:return o=H.a.apply(void 0,[H.a.apply(void 0,l.concat([v.sent()])),{name:a,$metadata:De(e)}]),[3,19];case 10:return u=[{}],[4,je(n,t)];case 11:return o=H.a.apply(void 0,[H.a.apply(void 0,u.concat([v.sent()])),{name:a,$metadata:De(e)}]),[3,19];case 12:return d=[{}],[4,Ee(n,t)];case 13:return o=H.a.apply(void 0,[H.a.apply(void 0,d.concat([v.sent()])),{name:a,$metadata:De(e)}]),[3,19];case 14:return m=[{}],[4,Ce(n,t)];case 15:return o=H.a.apply(void 0,[H.a.apply(void 0,m.concat([v.sent()])),{name:a,$metadata:De(e)}]),[3,19];case 16:return p=[{}],[4,Le(n,t)];case 17:return o=H.a.apply(void 0,[H.a.apply(void 0,p.concat([v.sent()])),{name:a,$metadata:De(e)}]),[3,19];case 18:a=(f=n.body).code||f.Code||a,o=Object(H.a)(Object(H.a)({},f),{name:""+a,message:f.message||f.Message||a,$fault:"client",$metadata:De(e)}),v.label=19;case 19:return o.message=h=o.message||o.Message||a,delete o.Message,[2,Promise.reject(Object.assign(new Error(h),o))]}})})},we=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var t,n;return Object(H.e)(this,function(i){return t={name:"BadGatewayException",$fault:"server",$metadata:De(e),Message:void 0},null!=(n=e.body).Message&&(t.Message=n.Message),[2,t]})})},xe=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var t,n;return Object(H.e)(this,function(i){return t={name:"BadRequestException",$fault:"client",$metadata:De(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]})})},Oe=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var t,n;return Object(H.e)(this,function(i){return t={name:"ConflictException",$fault:"client",$metadata:De(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]})})},Se=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var t,n;return Object(H.e)(this,function(i){return t={name:"DependencyFailedException",$fault:"client",$metadata:De(e),Message:void 0},null!=(n=e.body).Message&&(t.Message=n.Message),[2,t]})})},je=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var t,n;return Object(H.e)(this,function(i){return t={name:"InternalFailureException",$fault:"server",$metadata:De(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]})})},Ee=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var t,n;return Object(H.e)(this,function(i){return t={name:"LimitExceededException",$fault:"client",$metadata:De(e),message:void 0,retryAfterSeconds:void 0},void 0!==e.headers["retry-after"]&&(t.retryAfterSeconds=e.headers["retry-after"]),null!=(n=e.body).message&&(t.message=n.message),[2,t]})})},Ce=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var t,n;return Object(H.e)(this,function(i){return t={name:"LoopDetectedException",$fault:"server",$metadata:De(e),Message:void 0},null!=(n=e.body).Message&&(t.Message=n.Message),[2,t]})})},Te=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var t,n;return Object(H.e)(this,function(i){return t={name:"NotAcceptableException",$fault:"client",$metadata:De(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]})})},Le=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var t,n;return Object(H.e)(this,function(i){return t={name:"NotFoundException",$fault:"client",$metadata:De(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]})})},Ie=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var t,n;return Object(H.e)(this,function(i){return t={name:"RequestTimeoutException",$fault:"client",$metadata:De(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]})})},ke=function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var t,n;return Object(H.e)(this,function(i){return t={name:"UnsupportedMediaTypeException",$fault:"client",$metadata:De(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]})})},Ae=function(e,t){return Object.entries(e).reduce(function(e,t){var n,i=Object(H.g)(t,2),o=i[0],a=i[1];return null===a?e:Object(H.a)(Object(H.a)({},e),((n={})[o]=a,n))},{})},Ne=function(e,t){return e.filter(function(e){return null!=e}).map(function(e){return null===e?null:function(e,t){return Object(H.a)(Object(H.a)(Object(H.a)({},null!=e.name&&{name:e.name}),null!=e.parameters&&{parameters:Ae(e.parameters)}),null!=e.timeToLive&&{timeToLive:ze(e.timeToLive,t)})}(e,t)})},ze=function(e,t){return Object(H.a)(Object(H.a)({},null!=e.timeToLiveInSeconds&&{timeToLiveInSeconds:e.timeToLiveInSeconds}),null!=e.turnsToLive&&{turnsToLive:e.turnsToLive})},Re=function(e,t){return Object.entries(e).reduce(function(e,t){var n,i=Object(H.g)(t,2),o=i[0],a=i[1];return null===a?e:Object(H.a)(Object(H.a)({},e),((n={})[o]=a,n))},{})},_e=function(e,t){return Object.entries(e).reduce(function(e,t){var n,i=Object(H.g)(t,2),o=i[0],a=i[1];return null===a?e:Object(H.a)(Object(H.a)({},e),((n={})[o]=a,n))},{})},Pe=function(e,t){return{timeToLiveInSeconds:null!=e.timeToLiveInSeconds?e.timeToLiveInSeconds:void 0,turnsToLive:null!=e.turnsToLive?e.turnsToLive:void 0}},Be=function(e,t){return(e||[]).filter(function(e){return null!=e}).map(function(e){return null===e?null:function(e,t){return{attachmentLinkUrl:null!=e.attachmentLinkUrl?e.attachmentLinkUrl:void 0,buttons:null!=e.buttons?Me(e.buttons,t):void 0,imageUrl:null!=e.imageUrl?e.imageUrl:void 0,subTitle:null!=e.subTitle?e.subTitle:void 0,title:null!=e.title?e.title:void 0}}(e,t)})},Fe=function(e,t){return{score:null!=e.score?e.score:void 0}},Me=function(e,t){return(e||[]).filter(function(e){return null!=e}).map(function(e){return null===e?null:function(e,t){return{text:null!=e.text?e.text:void 0,value:null!=e.value?e.value:void 0}}(e)})},Ue=function(e,t){return Object.entries(e).reduce(function(e,t){var n,i=Object(H.g)(t,2),o=i[0],a=i[1];return null===a?e:Object(H.a)(Object(H.a)({},e),((n={})[o]=a,n))},{})},De=function(e){var t;return{httpStatusCode:e.statusCode,requestId:null!==(t=e.headers["x-amzn-requestid"])&&void 0!==t?t:e.headers["x-amzn-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}},$e=function(e){return!(null==e||""===e||Object.getOwnPropertyNames(e).includes("length")&&0==e.length||Object.getOwnPropertyNames(e).includes("size")&&0==e.size)},qe=function(e,t){return function(e,t){return function(e,t){return void 0===e&&(e=new Uint8Array),e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array)}(e,t).then(function(e){return t.utf8Encoder(e)})}(e,t).then(function(e){return e.length?JSON.parse(e):{}})},Ve=function(e,t){var n=function(e){var t=e;return t.indexOf(":")>=0&&(t=t.split(":")[0]),t.indexOf("#")>=0&&(t=t.split("#")[1]),t},i=Object.keys(e.headers).find(function(e){return e.toLowerCase()==="x-amzn-errortype".toLowerCase()});return void 0!==i?n(e.headers[i]):void 0!==t.code?n(t.code):void 0!==t.__type?n(t.__type):""},He=n("mRvm"),We=function(e){function t(t){var n=e.call(this)||this;return n.input=t,n}return Object(H.d)(t,e),t.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(Object(He.a)(t,this.serialize,this.deserialize));var i=e.concat(this.middlewareStack),o=t.requestHandler;return i.resolve(function(e){return o.handle(e.request,n||{})},{logger:t.logger,clientName:"LexRuntimeServiceClient",commandName:"PostTextCommand",inputFilterSensitiveLog:I.filterSensitiveLog,outputFilterSensitiveLog:B.filterSensitiveLog})},t.prototype.serialize=function(e,t){return function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var n,i,o,a,r,s;return Object(H.e)(this,function(c){switch(c.label){case 0:if(n={"content-type":"application/json"},i="/bot/{botName}/alias/{botAlias}/user/{userId}/text",void 0===e.botName)throw new Error("No value provided for input HTTP label: botName.");if((o=e.botName).length<=0)throw new Error("Empty value provided for input HTTP label: botName.");if(i=i.replace("{botName}",Object(fe.f)(o)),void 0===e.botAlias)throw new Error("No value provided for input HTTP label: botAlias.");if((o=e.botAlias).length<=0)throw new Error("Empty value provided for input HTTP label: botAlias.");if(i=i.replace("{botAlias}",Object(fe.f)(o)),void 0===e.userId)throw new Error("No value provided for input HTTP label: userId.");if((o=e.userId).length<=0)throw new Error("Empty value provided for input HTTP label: userId.");return i=i.replace("{userId}",Object(fe.f)(o)),a=JSON.stringify(Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)({},null!=e.activeContexts&&{activeContexts:Ne(e.activeContexts,t)}),null!=e.inputText&&{inputText:e.inputText}),null!=e.requestAttributes&&{requestAttributes:Re(e.requestAttributes)}),null!=e.sessionAttributes&&{sessionAttributes:Re(e.sessionAttributes)})),[4,t.endpoint()];case 1:return r=c.sent(),[2,new ve.a({protocol:void 0===(s=r.protocol)?"https":s,hostname:r.hostname,port:r.port,method:"POST",headers:n,path:i,body:a})]}})})}(e,t)},t.prototype.deserialize=function(e,t){return function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var n,i;return Object(H.e)(this,function(o){switch(o.label){case 0:return 200!==e.statusCode&&e.statusCode>=300?[2,ye(e,t)]:(n={$metadata:De(e),activeContexts:void 0,alternativeIntents:void 0,botVersion:void 0,dialogState:void 0,intentName:void 0,message:void 0,messageFormat:void 0,nluIntentConfidence:void 0,responseCard:void 0,sentimentResponse:void 0,sessionAttributes:void 0,sessionId:void 0,slotToElicit:void 0,slots:void 0},[4,qe(e.body,t)]);case 1:return null!=(i=o.sent()).activeContexts&&(n.activeContexts=function(e,t){return(e||[]).filter(function(e){return null!=e}).map(function(e){return null===e?null:function(e,t){return{name:null!=e.name?e.name:void 0,parameters:null!=e.parameters?_e(e.parameters):void 0,timeToLive:null!=e.timeToLive?Pe(e.timeToLive):void 0}}(e)})}(i.activeContexts)),null!=i.alternativeIntents&&(n.alternativeIntents=function(e,t){return(e||[]).filter(function(e){return null!=e}).map(function(e){return null===e?null:function(e,t){return{intentName:null!=e.intentName?e.intentName:void 0,nluIntentConfidence:null!=e.nluIntentConfidence?Fe(e.nluIntentConfidence):void 0,slots:null!=e.slots?Ue(e.slots,t):void 0}}(e,t)})}(i.alternativeIntents,t)),null!=i.botVersion&&(n.botVersion=i.botVersion),null!=i.dialogState&&(n.dialogState=i.dialogState),null!=i.intentName&&(n.intentName=i.intentName),null!=i.message&&(n.message=i.message),null!=i.messageFormat&&(n.messageFormat=i.messageFormat),null!=i.nluIntentConfidence&&(n.nluIntentConfidence=Fe(i.nluIntentConfidence)),null!=i.responseCard&&(n.responseCard=function(e,t){return{contentType:null!=e.contentType?e.contentType:void 0,genericAttachments:null!=e.genericAttachments?Be(e.genericAttachments,t):void 0,version:null!=e.version?e.version:void 0}}(i.responseCard,t)),null!=i.sentimentResponse&&(n.sentimentResponse=function(e,t){return{sentimentLabel:null!=e.sentimentLabel?e.sentimentLabel:void 0,sentimentScore:null!=e.sentimentScore?e.sentimentScore:void 0}}(i.sentimentResponse)),null!=i.sessionAttributes&&(n.sessionAttributes=Ue(i.sessionAttributes,t)),null!=i.sessionId&&(n.sessionId=i.sessionId),null!=i.slotToElicit&&(n.slotToElicit=i.slotToElicit),null!=i.slots&&(n.slots=Ue(i.slots,t)),[2,Promise.resolve(n)]}})})}(e,t)},t}(fe.b),Je=function(e){function t(t){var n=e.call(this)||this;return n.input=t,n}return Object(H.d)(t,e),t.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(Object(He.a)(t,this.serialize,this.deserialize));var i=e.concat(this.middlewareStack),o=t.requestHandler;return i.resolve(function(e){return o.handle(e.request,n||{})},{logger:t.logger,clientName:"LexRuntimeServiceClient",commandName:"PostContentCommand",inputFilterSensitiveLog:j.filterSensitiveLog,outputFilterSensitiveLog:C.filterSensitiveLog})},t.prototype.serialize=function(e,t){return function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var n,i,o,a,r,s;return Object(H.e)(this,function(c){switch(c.label){case 0:if(n=Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)(Object(H.a)({"content-type":"application/octet-stream","x-amz-content-sha256":"UNSIGNED-PAYLOAD"},$e(e.sessionAttributes)&&{"x-amz-lex-session-attributes":Buffer.from(fe.c.fromObject(e.sessionAttributes)).toString("base64")}),$e(e.requestAttributes)&&{"x-amz-lex-request-attributes":Buffer.from(fe.c.fromObject(e.requestAttributes)).toString("base64")}),$e(e.contentType)&&{"content-type":e.contentType}),$e(e.accept)&&{accept:e.accept}),$e(e.activeContexts)&&{"x-amz-lex-active-contexts":Buffer.from(fe.c.fromObject(e.activeContexts)).toString("base64")}),i="/bot/{botName}/alias/{botAlias}/user/{userId}/content",void 0===e.botName)throw new Error("No value provided for input HTTP label: botName.");if((o=e.botName).length<=0)throw new Error("Empty value provided for input HTTP label: botName.");if(i=i.replace("{botName}",Object(fe.f)(o)),void 0===e.botAlias)throw new Error("No value provided for input HTTP label: botAlias.");if((o=e.botAlias).length<=0)throw new Error("Empty value provided for input HTTP label: botAlias.");if(i=i.replace("{botAlias}",Object(fe.f)(o)),void 0===e.userId)throw new Error("No value provided for input HTTP label: userId.");if((o=e.userId).length<=0)throw new Error("Empty value provided for input HTTP label: userId.");return i=i.replace("{userId}",Object(fe.f)(o)),void 0!==e.inputStream&&(a=e.inputStream),[4,t.endpoint()];case 1:return r=c.sent(),[2,new ve.a({protocol:void 0===(s=r.protocol)?"https":s,hostname:r.hostname,port:r.port,method:"POST",headers:n,path:i,body:a})]}})})}(e,t)},t.prototype.deserialize=function(e,t){return function(e,t){return Object(H.b)(void 0,void 0,void 0,function(){var n;return Object(H.e)(this,function(i){return 200!==e.statusCode&&e.statusCode>=300?[2,ge(e,t)]:(n={$metadata:De(e),activeContexts:void 0,alternativeIntents:void 0,audioStream:void 0,botVersion:void 0,contentType:void 0,dialogState:void 0,inputTranscript:void 0,intentName:void 0,message:void 0,messageFormat:void 0,nluIntentConfidence:void 0,sentimentResponse:void 0,sessionAttributes:void 0,sessionId:void 0,slotToElicit:void 0,slots:void 0},void 0!==e.headers["content-type"]&&(n.contentType=e.headers["content-type"]),void 0!==e.headers["x-amz-lex-intent-name"]&&(n.intentName=e.headers["x-amz-lex-intent-name"]),void 0!==e.headers["x-amz-lex-nlu-intent-confidence"]&&(n.nluIntentConfidence=new fe.c(Buffer.from(e.headers["x-amz-lex-nlu-intent-confidence"],"base64").toString("ascii"))),void 0!==e.headers["x-amz-lex-alternative-intents"]&&(n.alternativeIntents=new fe.c(Buffer.from(e.headers["x-amz-lex-alternative-intents"],"base64").toString("ascii"))),void 0!==e.headers["x-amz-lex-slots"]&&(n.slots=new fe.c(Buffer.from(e.headers["x-amz-lex-slots"],"base64").toString("ascii"))),void 0!==e.headers["x-amz-lex-session-attributes"]&&(n.sessionAttributes=new fe.c(Buffer.from(e.headers["x-amz-lex-session-attributes"],"base64").toString("ascii"))),void 0!==e.headers["x-amz-lex-sentiment"]&&(n.sentimentResponse=e.headers["x-amz-lex-sentiment"]),void 0!==e.headers["x-amz-lex-message"]&&(n.message=e.headers["x-amz-lex-message"]),void 0!==e.headers["x-amz-lex-message-format"]&&(n.messageFormat=e.headers["x-amz-lex-message-format"]),void 0!==e.headers["x-amz-lex-dialog-state"]&&(n.dialogState=e.headers["x-amz-lex-dialog-state"]),void 0!==e.headers["x-amz-lex-slot-to-elicit"]&&(n.slotToElicit=e.headers["x-amz-lex-slot-to-elicit"]),void 0!==e.headers["x-amz-lex-input-transcript"]&&(n.inputTranscript=e.headers["x-amz-lex-input-transcript"]),void 0!==e.headers["x-amz-lex-bot-version"]&&(n.botVersion=e.headers["x-amz-lex-bot-version"]),void 0!==e.headers["x-amz-lex-session-id"]&&(n.sessionId=e.headers["x-amz-lex-session-id"]),void 0!==e.headers["x-amz-lex-active-contexts"]&&(n.activeContexts=new fe.c(Buffer.from(e.headers["x-amz-lex-active-contexts"],"base64").toString("ascii"))),n.audioStream=e.body,[2,Promise.resolve(n)])})})}(e,t)},t}(fe.b),Ge=n("R10A"),Xe=n("+rSW"),Ye=function(e){if(e instanceof Blob||e instanceof ReadableStream)return new Response(e).arrayBuffer().then(function(e){return new Uint8Array(e)});throw new Error("Readable is not supported.")},Ke=(be=function(e,t){return(be=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}be(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Ze=function(){return(Ze=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Qe=new U.a("AWSLexProvider"),et=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._botsCompleteCallback={},n}return Ke(t,e),t.prototype.getProviderName=function(){return"AWSLexProvider"},t.prototype.reportBotStatus=function(e,t){var n=this;Qe.debug("postContent state",e.dialogState),"ReadyForFulfillment"!==e.dialogState&&"Fulfilled"!==e.dialogState||("function"==typeof this._botsCompleteCallback[t]&&setTimeout(function(){return n._botsCompleteCallback[t](null,{slots:e.slots})},0),this._config&&"function"==typeof this._config[t].onComplete&&setTimeout(function(){return n._config[t].onComplete(null,{slots:e.slots})},0)),"Failed"===e.dialogState&&("function"==typeof this._botsCompleteCallback[t]&&setTimeout(function(){return n._botsCompleteCallback[t]("Bot conversation failed")},0),this._config&&"function"==typeof this._config[t].onComplete&&setTimeout(function(){return n._config[t].onComplete("Bot conversation failed")},0))},t.prototype.sendMessage=function(e,t){return n=this,void 0,o=function(){var n,i,o,a,r,s,c,l,u;return function(e,t){var n,i,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(s){a=[6,s],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,function(d){switch(d.label){case 0:return this._config[e]?[4,Ge.a.get()]:[2,Promise.reject("Bot "+e+" does not exist")];case 1:if(!(n=d.sent()))return[2,Promise.reject("No credentials")];if(this.lexRuntimeServiceClient=new he({region:this._config[e].region,credentials:n,customUserAgent:Object(Xe.b)()}),"string"!=typeof t)return[3,6];i={botAlias:this._config[e].alias,botName:e,inputText:t,userId:n.identityId},Qe.debug("postText to lex",t),d.label=2;case 2:return d.trys.push([2,4,,5]),o=new We(i),[4,this.lexRuntimeServiceClient.send(o)];case 3:return c=d.sent(),this.reportBotStatus(c,e),[2,c];case 4:return a=d.sent(),[2,Promise.reject(a)];case 5:return[3,11];case 6:r=t.content,i="voice"===t.options.messageType?{botAlias:this._config[e].alias,botName:e,contentType:"audio/x-l16; sample-rate=16000",inputStream:r,userId:n.identityId,accept:"audio/mpeg"}:{botAlias:this._config[e].alias,botName:e,contentType:"text/plain; charset=utf-8",inputStream:r,userId:n.identityId,accept:"audio/mpeg"},Qe.debug("postContent to lex",t),d.label=7;case 7:return d.trys.push([7,10,,11]),s=new Je(i),[4,this.lexRuntimeServiceClient.send(s)];case 8:return c=d.sent(),[4,Ye(c.audioStream)];case 9:return l=d.sent(),this.reportBotStatus(c,e),[2,Ze(Ze({},c),{audioStream:l})];case 10:return u=d.sent(),[2,Promise.reject(u)];case 11:return[2]}})},new((i=void 0)||(i=Promise))(function(e,t){function a(e){try{s(o.next(e))}catch(n){t(n)}}function r(e){try{s(o.throw(e))}catch(n){t(n)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i(function(e){e(n)})).then(a,r)}s((o=o.apply(n,[])).next())});var n,i,o},t.prototype.onComplete=function(e,t){if(!this._config[e])throw new ErrorEvent("Bot "+e+" does not exist");this._botsCompleteCallback[e]=t},t}(V),tt=function(){return(tt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},nt=new U.a("Interactions"),it=new(function(){function e(e){this._options=e,nt.debug("Interactions Options",this._options),this._pluggables={}}return e.prototype.getModuleName=function(){return"Interactions"},e.prototype.configure=function(e){var t=this,n=e?e.Interactions||e:{};nt.debug("configure Interactions",{opt:n}),this._options=tt(tt({bots:{}},n),n.Interactions);var i=this._options.aws_bots_config,o=this._options.bots;return!Object.keys(o).length&&i&&Array.isArray(i)&&i.forEach(function(e){t._options.bots[e.name]=e}),!this._pluggables.AWSLexProvider&&o&&Object.keys(o).map(function(e){return o[e]}).find(function(e){return!e.providerName||"AWSLexProvider"===e.providerName})&&(this._pluggables.AWSLexProvider=new et),Object.keys(this._pluggables).map(function(e){t._pluggables[e].configure(t._options.bots)}),this._options},e.prototype.addPluggable=function(e){if(e&&"Interactions"===e.getCategory()){if(this._pluggables[e.getProviderName()])throw new Error("Bot "+e.getProviderName()+" already plugged");return e.configure(this._options.bots),void(this._pluggables[e.getProviderName()]=e)}},e.prototype.send=function(e,t){return n=this,void 0,o=function(){var n;return function(e,t){var n,i,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(s){a=[6,s],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,function(i){switch(i.label){case 0:if(!this._options.bots||!this._options.bots[e])throw new Error("Bot "+e+" does not exist");if(!this._pluggables[n=this._options.bots[e].providerName||"AWSLexProvider"])throw new Error("Bot "+n+" does not have valid pluggin did you try addPluggable first?");return[4,this._pluggables[n].sendMessage(e,t)];case 1:return[2,i.sent()]}})},new((i=void 0)||(i=Promise))(function(e,t){function a(e){try{s(o.next(e))}catch(n){t(n)}}function r(e){try{s(o.throw(e))}catch(n){t(n)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i(function(e){e(n)})).then(a,r)}s((o=o.apply(n,[])).next())});var n,i,o},e.prototype.onComplete=function(e,t){if(!this._options.bots||!this._options.bots[e])throw new Error("Bot "+e+" does not exist");var n=this._options.bots[e].providerName||"AWSLexProvider";if(!this._pluggables[n])throw new Error("Bot "+n+" does not have valid pluggin did you try addPluggable first?");this._pluggables[n].onComplete(e,t)},e}())(null);D.a.register(it)}}]);